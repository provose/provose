<!DOCTYPE html> <html lang="en-US"> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <title>ec2_on_demand_instances - Provose</title> <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon"> <link rel="stylesheet" href="/assets/css/just-the-docs-default.css"> <script async src="https://www.googletagmanager.com/gtag/js?id=UA-156547622-4"></script> <script> window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'UA-156547622-4'); </script> <script type="text/javascript" src="/assets/js/vendor/lunr.min.js"></script> <script type="text/javascript" src="/assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> <!-- Begin Jekyll SEO tag v2.6.1 --> <title>ec2_on_demand_instances | Provose</title> <meta name="generator" content="Jekyll v3.9.0" /> <meta property="og:title" content="ec2_on_demand_instances" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="Provose is a Terraform super-module. You tell it what types of databases and containers you want to run on Amazon Web Services (AWS), and it automatically provisions certificates, security groups, IAM policies, and more." /> <meta property="og:description" content="Provose is a Terraform super-module. You tell it what types of databases and containers you want to run on Amazon Web Services (AWS), and it automatically provisions certificates, security groups, IAM policies, and more." /> <link rel="canonical" href="/v2.0/reference/ec2_on_demand_instances/" /> <meta property="og:url" content="/v2.0/reference/ec2_on_demand_instances/" /> <meta property="og:site_name" content="Provose" /> <script type="application/ld+json"> {"@type":"WebPage","description":"Provose is a Terraform super-module. You tell it what types of databases and containers you want to run on Amazon Web Services (AWS), and it automatically provisions certificates, security groups, IAM policies, and more.","headline":"ec2_on_demand_instances","url":"/v2.0/reference/ec2_on_demand_instances/","@context":"https://schema.org"}</script> <!-- End Jekyll SEO tag --> <!-- From https://www.osano.com/cookieconsent/download/ --> <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/cookieconsent@3/build/cookieconsent.min.css" /> <!-- From https://www.osano.com/cookieconsent/download/ --> <script src="https://cdn.jsdelivr.net/npm/cookieconsent@3/build/cookieconsent.min.js" data-cfasync="false"></script> <script> window.cookieconsent.initialise({ "palette": { "popup": { "background": "#252e39" }, "button": { "background": "#14a7d0" } }, "theme": "edgeless", "content": { "message": "Provose uses cookies in order for us to better understand users and catch our own mistakes.", "href": "https://provose.com/privacy/" } }); </script> </head> <body> <svg xmlns="http://www.w3.org/2000/svg" style="display: none;"> <symbol id="svg-link" viewBox="0 0 24 24"> <title>Link</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"> <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"> <title>Search</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"> <title>Menu</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"> <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"> <title>Expand</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"> <polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"> <title>Document</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"> <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> </svg> <div class="side-bar"> <div class="site-header"> <a href="/" class="site-title lh-tight"> Provose </a> <a href="#" id="menu-button" class="site-button"> <svg viewBox="0 0 24 24" class="icon"><use xlink:href="#svg-menu"></use></svg> </a> </div> <nav role="navigation" aria-label="Main" id="site-nav" class="site-nav"> <ul class="nav-list"><li class="nav-list-item"><a href="/" class="nav-list-link">Home</a></li><li class="nav-list-item"><a href="/about/" class="nav-list-link">About</a></li><li class="nav-list-item"><a href="/contributing/" class="nav-list-link">Contributing to Provose</a></li><li class="nav-list-item"><a href="/changelog/" class="nav-list-link">Changelog</a></li><li class="nav-list-item"><a href="/philosophy/" class="nav-list-link">Philosophy</a></li><li class="nav-list-item"><a href="/security/" class="nav-list-link">Security</a></li><li class="nav-list-item"><a href="/naming/" class="nav-list-link">DNS and naming conventions</a></li><li class="nav-list-item"><a href="/amazon-machine-images-amis/" class="nav-list-link">Amazon Machine Images (AMIs)</a></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/v3.0/" class="nav-list-link">Docs v3.0 (Stable)</a><ul class="nav-list "><li class="nav-list-item "><a href="/v3.0/release-notes/" class="nav-list-link">Release notes</a></li><li class="nav-list-item "><a href="/v3.0/tutorial/" class="nav-list-link">Tutorial</a></li><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/v3.0/reference/" class="nav-list-link">Reference v3.0 (Stable)</a><ul class="nav-list"><li class="nav-list-item "> <a href="/v3.0/reference/batch/" class="nav-list-link">batch</a> </li><li class="nav-list-item "> <a href="/v3.0/reference/containers/" class="nav-list-link">containers</a> </li><li class="nav-list-item "> <a href="/v3.0/reference/ec2_on_demand_instances/" class="nav-list-link">ec2_on_demand_instances</a> </li><li class="nav-list-item "> <a href="/v3.0/reference/ec2_spot_instances/" class="nav-list-link">ec2_spot_instances</a> </li><li class="nav-list-item "> <a href="/v3.0/reference/elastic_file_systems/" class="nav-list-link">elastic_file_systems</a> </li><li class="nav-list-item "> <a href="/v3.0/reference/elasticsearch_clusters/" class="nav-list-link">elasticsearch_clusters</a> </li><li class="nav-list-item "> <a href="/v3.0/reference/https_redirects/" class="nav-list-link">https_redirects</a> </li><li class="nav-list-item "> <a href="/v3.0/reference/images/" class="nav-list-link">images</a> </li><li class="nav-list-item "> <a href="/v3.0/reference/lustre_file_systems/" class="nav-list-link">lustre_file_systems</a> </li><li class="nav-list-item "> <a href="/v3.0/reference/mysql_clusters/" class="nav-list-link">mysql_clusters</a> </li><li class="nav-list-item "> <a href="/v3.0/reference/overrides/" class="nav-list-link">overrides</a> </li><li class="nav-list-item "> <a href="/v3.0/reference/postgresql_clusters/" class="nav-list-link">postgresql_clusters</a> </li><li class="nav-list-item "> <a href="/v3.0/reference/provose_config/" class="nav-list-link">provose_config</a> </li><li class="nav-list-item "> <a href="/v3.0/reference/redis_clusters/" class="nav-list-link">redis_clusters</a> </li><li class="nav-list-item "> <a href="/v3.0/reference/s3_buckets/" class="nav-list-link">s3_buckets</a> </li><li class="nav-list-item "> <a href="/v3.0/reference/secrets/" class="nav-list-link">secrets</a> </li><li class="nav-list-item "> <a href="/v3.0/reference/source/" class="nav-list-link">source</a> </li></ul></li><li class="nav-list-item "><a href="/v3.0/debugging/" class="nav-list-link">Debugging</a></li><li class="nav-list-item "><a href="/v3.0/uninstalling/" class="nav-list-link">Uninstalling Provose</a></li></ul></li><li class="nav-list-item active"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/v2.0/" class="nav-list-link">Docs v2.0 (Deprecated)</a><ul class="nav-list "><li class="nav-list-item "><a href="/v2.0/release-notes/" class="nav-list-link">Release notes</a></li><li class="nav-list-item "><a href="/v2.0/tutorial/" class="nav-list-link">Tutorial</a></li><li class="nav-list-item active"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/v2.0/reference/" class="nav-list-link">Reference v2.0 (Deprecated)</a><ul class="nav-list"><li class="nav-list-item "> <a href="/v2.0/reference/batch/" class="nav-list-link">batch</a> </li><li class="nav-list-item "> <a href="/v2.0/reference/containers/" class="nav-list-link">containers</a> </li><li class="nav-list-item active"> <a href="/v2.0/reference/ec2_on_demand_instances/" class="nav-list-link active">ec2_on_demand_instances</a> </li><li class="nav-list-item "> <a href="/v2.0/reference/ec2_spot_instances/" class="nav-list-link">ec2_spot_instances</a> </li><li class="nav-list-item "> <a href="/v2.0/reference/elastic_file_systems/" class="nav-list-link">elastic_file_systems</a> </li><li class="nav-list-item "> <a href="/v2.0/reference/elasticsearch_clusters/" class="nav-list-link">elasticsearch_clusters</a> </li><li class="nav-list-item "> <a href="/v2.0/reference/https_redirects/" class="nav-list-link">https_redirects</a> </li><li class="nav-list-item "> <a href="/v2.0/reference/images/" class="nav-list-link">images</a> </li><li class="nav-list-item "> <a href="/v2.0/reference/lustre_file_systems/" class="nav-list-link">lustre_file_systems</a> </li><li class="nav-list-item "> <a href="/v2.0/reference/mysql_clusters/" class="nav-list-link">mysql_clusters</a> </li><li class="nav-list-item "> <a href="/v2.0/reference/overrides/" class="nav-list-link">overrides</a> </li><li class="nav-list-item "> <a href="/v2.0/reference/postgresql_clusters/" class="nav-list-link">postgresql_clusters</a> </li><li class="nav-list-item "> <a href="/v2.0/reference/provose_config/" class="nav-list-link">provose_config</a> </li><li class="nav-list-item "> <a href="/v2.0/reference/redis_clusters/" class="nav-list-link">redis_clusters</a> </li><li class="nav-list-item "> <a href="/v2.0/reference/s3_buckets/" class="nav-list-link">s3_buckets</a> </li><li class="nav-list-item "> <a href="/v2.0/reference/secrets/" class="nav-list-link">secrets</a> </li><li class="nav-list-item "> <a href="/v2.0/reference/source/" class="nav-list-link">source</a> </li></ul></li><li class="nav-list-item "><a href="/v2.0/debugging/" class="nav-list-link">Debugging</a></li><li class="nav-list-item "><a href="/v2.0/uninstalling/" class="nav-list-link">Uninstalling Provose</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/v1.1/" class="nav-list-link">Docs v1.1 (Deprecated)</a><ul class="nav-list "><li class="nav-list-item "><a href="/v1.1/release-notes/" class="nav-list-link">Release notes</a></li><li class="nav-list-item "><a href="/v1.1/tutorial/" class="nav-list-link">Tutorial</a></li><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/v1.1/reference/" class="nav-list-link">Reference v1.1 (Deprecated)</a><ul class="nav-list"><li class="nav-list-item "> <a href="/v1.1/reference/containers/" class="nav-list-link">containers</a> </li><li class="nav-list-item "> <a href="/v1.1/reference/ec2_instances/" class="nav-list-link">ec2_instances</a> </li><li class="nav-list-item "> <a href="/v1.1/reference/elasticsearch_clusters/" class="nav-list-link">elasticsearch_clusters</a> </li><li class="nav-list-item "> <a href="/v1.1/reference/images/" class="nav-list-link">images</a> </li><li class="nav-list-item "> <a href="/v1.1/reference/mysql_clusters/" class="nav-list-link">mysql_clusters</a> </li><li class="nav-list-item "> <a href="/v1.1/reference/overrides/" class="nav-list-link">overrides</a> </li><li class="nav-list-item "> <a href="/v1.1/reference/postgresql_clusters/" class="nav-list-link">postgresql_clusters</a> </li><li class="nav-list-item "> <a href="/v1.1/reference/provose_config/" class="nav-list-link">provose_config</a> </li><li class="nav-list-item "> <a href="/v1.1/reference/redis_clusters/" class="nav-list-link">redis_clusters</a> </li><li class="nav-list-item "> <a href="/v1.1/reference/s3_buckets/" class="nav-list-link">s3_buckets</a> </li><li class="nav-list-item "> <a href="/v1.1/reference/secrets/" class="nav-list-link">secrets</a> </li><li class="nav-list-item "> <a href="/v1.1/reference/source/" class="nav-list-link">source</a> </li></ul></li><li class="nav-list-item "><a href="/v1.1/debugging/" class="nav-list-link">Debugging</a></li><li class="nav-list-item "><a href="/v1.1/uninstalling/" class="nav-list-link">Uninstalling Provose</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/v1.0/" class="nav-list-link">Docs v1.0 (Deprecated)</a><ul class="nav-list "><li class="nav-list-item "><a href="/v1.0/release-notes/" class="nav-list-link">Release notes</a></li><li class="nav-list-item "><a href="/v1.0/tutorial/" class="nav-list-link">Tutorial</a></li><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/v1.0/reference/" class="nav-list-link">Reference v1.0 (Deprecated)</a><ul class="nav-list"><li class="nav-list-item "> <a href="/v1.0/reference/containers/" class="nav-list-link">containers</a> </li><li class="nav-list-item "> <a href="/v1.0/reference/ec2_instances/" class="nav-list-link">ec2_instances</a> </li><li class="nav-list-item "> <a href="/v1.0/reference/elasticsearch_clusters/" class="nav-list-link">elasticsearch_clusters</a> </li><li class="nav-list-item "> <a href="/v1.0/reference/images/" class="nav-list-link">images</a> </li><li class="nav-list-item "> <a href="/v1.0/reference/mysql_clusters/" class="nav-list-link">mysql_clusters</a> </li><li class="nav-list-item "> <a href="/v1.0/reference/overrides/" class="nav-list-link">overrides</a> </li><li class="nav-list-item "> <a href="/v1.0/reference/postgresql_clusters/" class="nav-list-link">postgresql_clusters</a> </li><li class="nav-list-item "> <a href="/v1.0/reference/provose_config/" class="nav-list-link">provose_config</a> </li><li class="nav-list-item "> <a href="/v1.0/reference/redis_clusters/" class="nav-list-link">redis_clusters</a> </li><li class="nav-list-item "> <a href="/v1.0/reference/s3_buckets/" class="nav-list-link">s3_buckets</a> </li><li class="nav-list-item "> <a href="/v1.0/reference/secrets/" class="nav-list-link">secrets</a> </li><li class="nav-list-item "> <a href="/v1.0/reference/source/" class="nav-list-link">source</a> </li></ul></li><li class="nav-list-item "><a href="/v1.0/debugging/" class="nav-list-link">Debugging</a></li><li class="nav-list-item "><a href="/v1.0/uninstalling/" class="nav-list-link">Uninstalling Provose</a></li></ul></li></ul> </nav> <footer class="site-footer"> This site uses <a href="https://github.com/pmarsceill/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll. </footer> </div> <div class="main" id="top"> <div id="main-header" class="main-header"> <div class="search"> <div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search Provose" aria-label="Search Provose" autocomplete="off"> <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label> </div> <div id="search-results" class="search-results"></div> </div> <nav aria-label="Auxiliary" class="aux-nav"> <ul class="aux-nav-list"> <li class="aux-nav-list-item"> <a href="https://github.com/provose/provose.github.io/" class="site-button" > Docs on GitHub </a> </li> <li class="aux-nav-list-item"> <a href="https://github.com/provose/provose/" class="site-button" > Provose on GitHub </a> </li> <li class="aux-nav-list-item"> <a href="https://neocrym.com" class="site-button" > Neocrym.com </a> </li> </ul> </nav> </div> <div id="main-content-wrap" class="main-content-wrap"> <nav aria-label="Breadcrumb" class="breadcrumb-nav"> <ol class="breadcrumb-nav-list"> <li class="breadcrumb-nav-list-item"><a href="/v2.0/">Docs v2.0 (Deprecated)</a></li> <li class="breadcrumb-nav-list-item"><a href="/v2.0/reference/">Reference v2.0 (Deprecated)</a></li> <li class="breadcrumb-nav-list-item"><span>ec2_on_demand_instances</span></li> </ol> </nav> <div id="main-content" class="main-content" role="main"> <h1 id="ec2_on_demand_instances"> <a href="#ec2_on_demand_instances" class="anchor-heading" aria-labelledby="ec2_on_demand_instances"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> ec2_on_demand_instances </h1> <h2 id="description"> <a href="#description" class="anchor-heading" aria-labelledby="description"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Description </h2> <p>The Provose <code class="language-plaintext highlighter-rouge">ec2_on_demand_instances</code> module enables the creation and deployment of Amazon EC2 instances.</p> <p>The phrase “On Demand” means these are regular ol’ AWS instances that are billed at the same price per-second. This is in contrast to Spot instances–where the price can fluctuate over time–or Reserved Instances–which are partially or completely purchased upfront.</p> <p>If you are looking to deploy the same application across multiple services–perhaps behind an HTTP load balancer–you might find it handier to use the <a href="../containers/"><code class="language-plaintext highlighter-rouge">containers</code> module</a> instead.</p> <h2 id="examples"> <a href="#examples" class="anchor-heading" aria-labelledby="examples"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Examples </h2> <div class="language-terraform highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">module</span> <span class="s2">"myproject"</span> <span class="p">{</span>
  <span class="nx">source</span> <span class="p">=</span> <span class="s2">"github.com/provose/provose?ref=v2.0.0"</span>
  <span class="nx">provose_config</span> <span class="p">=</span> <span class="p">{</span>
    <span class="nx">authentication</span> <span class="p">=</span> <span class="p">{</span>
      <span class="nx">aws</span> <span class="p">=</span> <span class="p">{</span>
        <span class="nx">region</span> <span class="p">=</span> <span class="s2">"us-east-1"</span>
      <span class="p">}</span>
    <span class="p">}</span>
    <span class="nx">name</span>                 <span class="p">=</span> <span class="s2">"myproject"</span>
    <span class="nx">internal_root_domain</span> <span class="p">=</span> <span class="s2">"example-internal.com"</span>
    <span class="nx">internal_subdomain</span>   <span class="p">=</span> <span class="s2">"production"</span>
  <span class="p">}</span>
  <span class="nx">ec2_on_demand_instances</span> <span class="p">=</span> <span class="p">{</span>
    <span class="nx">my</span><span class="err">-</span><span class="nx">instance</span><span class="err">-</span><span class="nx">name</span> <span class="p">=</span> <span class="p">{</span>
      <span class="nx">instances</span> <span class="p">=</span> <span class="p">{</span>
        <span class="nx">instance_type</span> <span class="p">=</span> <span class="s2">"t3.micro"</span>
        <span class="c1"># Create and name keys pairs in the AWS console. You can attach</span>
        <span class="c1"># one key pair to an instance on creation, but then you can add</span>
        <span class="c1"># more SSH keys via the user's ~/.ssh/authorized_keys file.</span>
        <span class="nx">key_name</span> <span class="p">=</span> <span class="s2">"james_laptop"</span>
      <span class="p">}</span>
      <span class="nx">public</span> <span class="p">=</span> <span class="p">{</span>
        <span class="c1"># Open port 22 for public SSH access.</span>
        <span class="nx">tcp</span> <span class="p">=</span> <span class="p">[</span><span class="mi">22</span><span class="p">]</span>
      <span class="p">}</span>
      <span class="nx">vpc</span> <span class="p">=</span> <span class="p">{</span>
        <span class="c1"># Open ports 80 and 443 to run HTTP and HTTPS servers only</span>
        <span class="c1"># available in the VPC.</span>
        <span class="nx">tcp</span> <span class="p">=</span> <span class="p">[</span><span class="mi">80</span><span class="p">,</span> <span class="mi">443</span><span class="p">]</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>

</code></pre></div></div> <h2 id="inputs"> <a href="#inputs" class="anchor-heading" aria-labelledby="inputs"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Inputs </h2> <ul> <li> <p><code class="language-plaintext highlighter-rouge">instances</code> – <strong>Required.</strong> This object contains various meta-settings about the AWS instance.</p> <ul> <li> <p><code class="language-plaintext highlighter-rouge">instance_type</code> – <strong>Required.</strong> The instance type.</p> </li> <li> <p><code class="language-plaintext highlighter-rouge">instance_count</code> – <strong>Optional.</strong> The number of instances to deploy. This defaults to 1. If you deploy one instance named <code class="language-plaintext highlighter-rouge">bob</code>, then it will be named <code class="language-plaintext highlighter-rouge">bob</code> in the AWS console and Provose creates a DNS record for your internal subdomain named <code class="language-plaintext highlighter-rouge">bob</code>. If you set <code class="language-plaintext highlighter-rouge">instance_count</code> to be greater than one, then the instances will be <code class="language-plaintext highlighter-rouge">bob-1</code>, <code class="language-plaintext highlighter-rouge">bob-2</code>, and so forth.</p> </li> <li> <p><code class="language-plaintext highlighter-rouge">key_name</code> – <strong>Optional.</strong> The name of the AWS key pair.</p> </li> <li> <p><code class="language-plaintext highlighter-rouge">ami_id</code> – <strong>Optional.</strong> The ID of the Amazon Machine Image (AMI) to deploy for this instance. By default, Provose will deploy an ECS-optimized GPU-ready Amazon Linux 2 AMI–specifically <code class="language-plaintext highlighter-rouge">amzn2-ami-ecs-gpu-hvm-2.0.20200218-x86_64-ebs</code>. New users of Provose might want to choose a newer AMI, but Provose cannot update the default AMI for existing users without causing their existing instances to be destroyed and recreated.</p> </li> <li> <p><code class="language-plaintext highlighter-rouge">availability_zone</code> – <strong>Optional.</strong> Set this to a specific Availability Zone in your AWS Region if you have a preference for what availability zone to deploy your instance in.</p> </li> <li> <p><code class="language-plaintext highlighter-rouge">bash_user_data</code> – <strong>Optional.</strong> This is a <a href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/user-data.html">user data script</a>–a Bash script that will be run on the EC2 instance’s creation. This script will not be rerun when the instance reboots. Provose currently does not support the cloud-init standard for user data.</p> </li> </ul> </li> <li> <p><code class="language-plaintext highlighter-rouge">public</code> – <strong>Optional.</strong> This is a grouping for network settings for the public Internet.</p> <ul> <li> <p><code class="language-plaintext highlighter-rouge">tcp</code> <strong>Optional.</strong> This is a list of TCP ports to open to the public Internet.</p> </li> <li> <p><code class="language-plaintext highlighter-rouge">udp</code> <strong>Optional.</strong> This is a list of UDP ports to open to the public Internet.</p> </li> </ul> </li> <li> <p><code class="language-plaintext highlighter-rouge">vpc</code> – <strong>Optional.</strong> This is a grouping for network settings only within the Virtual Private Cloud (VPC) that Provose creates.</p> </li> <li> <p><code class="language-plaintext highlighter-rouge">secrets</code> – <strong>Optional.</strong> This is a <em>list</em> of AWS Secrets Manager secret names that this EC2 instance should have access to. This setting <em>only</em> configures access. You have to fetch the secrets yourself in your application with the AWS API. The secrets key in the <a href="../containers/"><code class="language-plaintext highlighter-rouge">containers</code> module</a> goes a step further and loads your secrets as environment variables.</p> </li> <li> <p><code class="language-plaintext highlighter-rouge">associate_public_ip_address</code> – <strong>Optional.</strong> Defaults to <code class="language-plaintext highlighter-rouge">true</code>, which provisions a public IPv4 address for this instance. However, it will not be possible to make inbound requests to the instance using this IP address unless you also choose to open TCP ports with the <code class="language-plaintext highlighter-rouge">public.tcp</code> key or the UDP ports with the <code class="language-plaintext highlighter-rouge">public.udp</code> key. The public IP address that AWS gives this instance should be considered temporary. If you want a more permanent IP address, you should provision an Elastic IP and assign it to this instance.</p> </li> <li> <p><code class="language-plaintext highlighter-rouge">vpc_security_group_ids</code> – <strong>Optional.</strong> This key is for adding <em>additional, custom</em> security groups in addition to what Provose sets up from the <code class="language-plaintext highlighter-rouge">public</code> and <code class="language-plaintext highlighter-rouge">vpc</code> keys. You may want to add a custom security group with a more specific CIDR.</p> </li> <li> <p><code class="language-plaintext highlighter-rouge">root_block_device</code> – <strong>Optional</strong> These are optional settings about the Elastic Block Storage (EBS) volume that stores the root filesystem for this EC2 instance.</p> <ul> <li> <p><code class="language-plaintext highlighter-rouge">volume_type</code> – <strong>Optional.</strong> This is the type of EBS volume. Values can be either <code class="language-plaintext highlighter-rouge">"standard"</code>, <code class="language-plaintext highlighter-rouge">"gp2"</code>, <code class="language-plaintext highlighter-rouge">"io1"</code>, <code class="language-plaintext highlighter-rouge">"sc1"</code>, or <code class="language-plaintext highlighter-rouge">"st1"</code>, with <code class="language-plaintext highlighter-rouge">"standard"</code> being the default.</p> </li> <li> <p><code class="language-plaintext highlighter-rouge">volume_size_gb</code> – <strong>Optional.</strong> This is the size of the EBS volume in gigabytes. This defaults to the root volume size defined in the underlying Amazon Machine Image (AMI) and will never be less than the minimum.</p> </li> <li> <p><code class="language-plaintext highlighter-rouge">delete_on_termination</code> – <strong>Optional.</strong> This defaults to <code class="language-plaintext highlighter-rouge">true</code>, which deletes the EBS volume if the instance is terminated. Set this to <code class="language-plaintext highlighter-rouge">false</code> to keep the root EBS volume in your account after instance termination.</p> </li> <li> <p><code class="language-plaintext highlighter-rouge">encrypted</code> – <strong>Optional.</strong> Set this to <code class="language-plaintext highlighter-rouge">true</code> to encrypt the EBS volume. This value is <code class="language-plaintext highlighter-rouge">false</code> by default.</p> </li> <li> <p><code class="language-plaintext highlighter-rouge">kms_key_id</code> – <strong>Optional.</strong> This is the Amazon Resource Name (ARN) for the custom AWS Key Management Service (KMS) key that you would like to use to encrypt the drive.</p> </li> </ul> </li> <li> <p><code class="language-plaintext highlighter-rouge">s3_buckets</code> – <strong>Optional.</strong> This is a mapping of S3 buckets to the classes of permissions available to the instances. The four classes of permissions available are <code class="language-plaintext highlighter-rouge">list</code>, <code class="language-plaintext highlighter-rouge">get</code>, <code class="language-plaintext highlighter-rouge">put</code>, and <code class="language-plaintext highlighter-rouge">delete</code>, and the values for each one is <code class="language-plaintext highlighter-rouge">true</code> or <code class="language-plaintext highlighter-rouge">false</code>. To use this configuration, place the <code class="language-plaintext highlighter-rouge">s3_buckets</code> key <strong>inside</strong> a block that defines an instance. Below is an example of how to give an EC2 instance access to two buckets–one with <code class="language-plaintext highlighter-rouge">list</code> and <code class="language-plaintext highlighter-rouge">get</code> permissions, and another with <code class="language-plaintext highlighter-rouge">get</code> and <code class="language-plaintext highlighter-rouge">delete</code> permissions.</p> </li> </ul> <div class="language-terraform highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">s3_buckets</span> <span class="err">=</span> <span class="p">{</span>
  <span class="s2">"some-bucket-name.example-internal.com"</span> <span class="p">=</span> <span class="p">{</span>
    <span class="nx">permissions</span> <span class="p">=</span> <span class="p">{</span>
      <span class="nx">list</span>   <span class="p">=</span> <span class="kc">true</span>
      <span class="nx">get</span>    <span class="p">=</span> <span class="kc">true</span>
      <span class="nx">put</span>    <span class="p">=</span> <span class="kc">false</span>
      <span class="nx">delete</span> <span class="p">=</span> <span class="kc">false</span>
    <span class="p">}</span>
  <span class="p">}</span>
  <span class="s2">"another-bucket.com"</span> <span class="p">=</span> <span class="p">{</span>
    <span class="nx">permissions</span> <span class="p">=</span> <span class="p">{</span>
      <span class="nx">list</span>   <span class="p">=</span> <span class="kc">false</span>
      <span class="nx">get</span>    <span class="p">=</span> <span class="kc">true</span>
      <span class="nx">put</span>    <span class="p">=</span> <span class="kc">false</span>
      <span class="nx">delete</span> <span class="p">=</span> <span class="kc">true</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div> <h2 id="outputs"> <a href="#outputs" class="anchor-heading" aria-labelledby="outputs"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Outputs </h2> <ul> <li> <p><code class="language-plaintext highlighter-rouge">ec2_on_demand_instances.aws_security_group.ec2_on_demand_instances</code> – A map with a key for every instance and every value is a Terraform <a href="https://www.terraform.io/docs/providers/aws/r/security_group.html"><code class="language-plaintext highlighter-rouge">aws_security_group</code></a> type.</p> </li> <li> <p><code class="language-plaintext highlighter-rouge">ec2_on_demand_instances.aws_instance.ec2_on_demand_instances</code> – A map with the keys as the names of the on-demand instances–dashed with a number if we set the <code class="language-plaintext highlighter-rouge">instances.instance_count</code> parameter to be greater than 1. Each value is a Terraform <a href="https://www.terraform.io/docs/providers/aws/r/instance.html"><code class="language-plaintext highlighter-rouge">aws_instance</code></a> type.</p> </li> <li> <p><code class="language-plaintext highlighter-rouge">ec2_on_demand_instances.aws_route53_record.ec2_on_demand_instances</code> – This is a mapping from the names EC2 On-Demand instances to the <a href="https://www.terraform.io/docs/providers/aws/r/route53_record.html"><code class="language-plaintext highlighter-rouge">aws_route53_record</code> resource</a> that describes the DNS records internal to the VPC.</p> </li> </ul> <hr> <footer> <p class="text-small text-grey-dk-100 mb-0">Copyright &copy; 2020 <a href="https://neocrym.com">Neocrym Records Inc</a>. Distributed via an <a href="https://github.com/provose/provose.github.io/blob/master/LICENSE">MIT license</a>. <a href="/privacy/">Privacy Policy</a>.</p> </footer> </div> </div> <div class="search-overlay"></div> </div> </body> </html>
