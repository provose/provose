<!DOCTYPE html> <html lang="en-US"> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <title>batch - Provose</title> <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon"> <link rel="stylesheet" href="/assets/css/just-the-docs-default.css"> <script async src="https://www.googletagmanager.com/gtag/js?id=UA-156547622-4"></script> <script> window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'UA-156547622-4'); </script> <script type="text/javascript" src="/assets/js/vendor/lunr.min.js"></script> <script type="text/javascript" src="/assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> <!-- Begin Jekyll SEO tag v2.7.1 --> <title>batch | Provose</title> <meta name="generator" content="Jekyll v3.9.0" /> <meta property="og:title" content="batch" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="Provose is a Terraform super-module. You tell it what types of databases and containers you want to run on Amazon Web Services (AWS), and it automatically provisions certificates, security groups, IAM policies, and more." /> <meta property="og:description" content="Provose is a Terraform super-module. You tell it what types of databases and containers you want to run on Amazon Web Services (AWS), and it automatically provisions certificates, security groups, IAM policies, and more." /> <link rel="canonical" href="/v3.0/reference/batch/" /> <meta property="og:url" content="/v3.0/reference/batch/" /> <meta property="og:site_name" content="Provose" /> <meta name="twitter:card" content="summary" /> <meta property="twitter:title" content="batch" /> <script type="application/ld+json"> {"description":"Provose is a Terraform super-module. You tell it what types of databases and containers you want to run on Amazon Web Services (AWS), and it automatically provisions certificates, security groups, IAM policies, and more.","@type":"WebPage","headline":"batch","publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"/assets/images/1x/logo-black-on-transparent-1x.png"}},"url":"/v3.0/reference/batch/","@context":"https://schema.org"}</script> <!-- End Jekyll SEO tag --> <!-- From https://www.osano.com/cookieconsent/download/ --> <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/cookieconsent@3/build/cookieconsent.min.css" /> <!-- From https://www.osano.com/cookieconsent/download/ --> <script src="https://cdn.jsdelivr.net/npm/cookieconsent@3/build/cookieconsent.min.js" data-cfasync="false"></script> <script> window.cookieconsent.initialise({ "palette": { "popup": { "background": "#252e39" }, "button": { "background": "#14a7d0" } }, "theme": "edgeless", "content": { "message": "Provose uses cookies in order for us to better understand users and catch our own mistakes.", "href": "https://provose.com/privacy/" } }); </script> </head> <body> <svg xmlns="http://www.w3.org/2000/svg" style="display: none;"> <symbol id="svg-link" viewBox="0 0 24 24"> <title>Link</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"> <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"> <title>Search</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"> <title>Menu</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"> <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"> <title>Expand</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"> <polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"> <title>Document</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"> <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> </svg> <div class="side-bar"> <div class="site-header"> <a href="/" class="site-title lh-tight"> <div class="site-logo"></div> </a> <a href="#" id="menu-button" class="site-button"> <svg viewBox="0 0 24 24" class="icon"><use xlink:href="#svg-menu"></use></svg> </a> </div> <nav role="navigation" aria-label="Main" id="site-nav" class="site-nav"> <ul class="nav-list"><li class="nav-list-item"><a href="/" class="nav-list-link">Home</a></li><li class="nav-list-item"><a href="/about/" class="nav-list-link">About</a></li><li class="nav-list-item"><a href="/contributing/" class="nav-list-link">Contributing to Provose</a></li><li class="nav-list-item"><a href="/changelog/" class="nav-list-link">Changelog</a></li><li class="nav-list-item"><a href="/philosophy/" class="nav-list-link">Philosophy</a></li><li class="nav-list-item"><a href="/security/" class="nav-list-link">Security</a></li><li class="nav-list-item"><a href="/naming/" class="nav-list-link">DNS and naming conventions</a></li><li class="nav-list-item"><a href="/amazon-machine-images-amis/" class="nav-list-link">Amazon Machine Images (AMIs)</a></li><li class="nav-list-item active"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/v3.0/" class="nav-list-link">Docs v3.0 (Stable)</a><ul class="nav-list "><li class="nav-list-item "><a href="/v3.0/release-notes/" class="nav-list-link">Release notes</a></li><li class="nav-list-item "><a href="/v3.0/tutorial/" class="nav-list-link">Tutorial</a></li><li class="nav-list-item active"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/v3.0/reference/" class="nav-list-link">Reference v3.0 (Stable)</a><ul class="nav-list"><li class="nav-list-item active"> <a href="/v3.0/reference/batch/" class="nav-list-link active">batch</a> </li><li class="nav-list-item "> <a href="/v3.0/reference/containers/" class="nav-list-link">containers</a> </li><li class="nav-list-item "> <a href="/v3.0/reference/ec2_on_demand_instances/" class="nav-list-link">ec2_on_demand_instances</a> </li><li class="nav-list-item "> <a href="/v3.0/reference/ec2_spot_instances/" class="nav-list-link">ec2_spot_instances</a> </li><li class="nav-list-item "> <a href="/v3.0/reference/elastic_file_systems/" class="nav-list-link">elastic_file_systems</a> </li><li class="nav-list-item "> <a href="/v3.0/reference/elasticsearch_clusters/" class="nav-list-link">elasticsearch_clusters</a> </li><li class="nav-list-item "> <a href="/v3.0/reference/https_redirects/" class="nav-list-link">https_redirects</a> </li><li class="nav-list-item "> <a href="/v3.0/reference/images/" class="nav-list-link">images</a> </li><li class="nav-list-item "> <a href="/v3.0/reference/lustre_file_systems/" class="nav-list-link">lustre_file_systems</a> </li><li class="nav-list-item "> <a href="/v3.0/reference/mysql_clusters/" class="nav-list-link">mysql_clusters</a> </li><li class="nav-list-item "> <a href="/v3.0/reference/overrides/" class="nav-list-link">overrides</a> </li><li class="nav-list-item "> <a href="/v3.0/reference/postgresql_clusters/" class="nav-list-link">postgresql_clusters</a> </li><li class="nav-list-item "> <a href="/v3.0/reference/provose_config/" class="nav-list-link">provose_config</a> </li><li class="nav-list-item "> <a href="/v3.0/reference/redis_clusters/" class="nav-list-link">redis_clusters</a> </li><li class="nav-list-item "> <a href="/v3.0/reference/s3_buckets/" class="nav-list-link">s3_buckets</a> </li><li class="nav-list-item "> <a href="/v3.0/reference/secrets/" class="nav-list-link">secrets</a> </li><li class="nav-list-item "> <a href="/v3.0/reference/source/" class="nav-list-link">source</a> </li></ul></li><li class="nav-list-item "><a href="/v3.0/debugging/" class="nav-list-link">Debugging</a></li><li class="nav-list-item "><a href="/v3.0/uninstalling/" class="nav-list-link">Uninstalling Provose</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/v2.0/" class="nav-list-link">Docs v2.0 (Deprecated)</a><ul class="nav-list "><li class="nav-list-item "><a href="/v2.0/release-notes/" class="nav-list-link">Release notes</a></li><li class="nav-list-item "><a href="/v2.0/tutorial/" class="nav-list-link">Tutorial</a></li><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/v2.0/reference/" class="nav-list-link">Reference v2.0 (Deprecated)</a><ul class="nav-list"><li class="nav-list-item "> <a href="/v2.0/reference/batch/" class="nav-list-link">batch</a> </li><li class="nav-list-item "> <a href="/v2.0/reference/containers/" class="nav-list-link">containers</a> </li><li class="nav-list-item "> <a href="/v2.0/reference/ec2_on_demand_instances/" class="nav-list-link">ec2_on_demand_instances</a> </li><li class="nav-list-item "> <a href="/v2.0/reference/ec2_spot_instances/" class="nav-list-link">ec2_spot_instances</a> </li><li class="nav-list-item "> <a href="/v2.0/reference/elastic_file_systems/" class="nav-list-link">elastic_file_systems</a> </li><li class="nav-list-item "> <a href="/v2.0/reference/elasticsearch_clusters/" class="nav-list-link">elasticsearch_clusters</a> </li><li class="nav-list-item "> <a href="/v2.0/reference/https_redirects/" class="nav-list-link">https_redirects</a> </li><li class="nav-list-item "> <a href="/v2.0/reference/images/" class="nav-list-link">images</a> </li><li class="nav-list-item "> <a href="/v2.0/reference/lustre_file_systems/" class="nav-list-link">lustre_file_systems</a> </li><li class="nav-list-item "> <a href="/v2.0/reference/mysql_clusters/" class="nav-list-link">mysql_clusters</a> </li><li class="nav-list-item "> <a href="/v2.0/reference/overrides/" class="nav-list-link">overrides</a> </li><li class="nav-list-item "> <a href="/v2.0/reference/postgresql_clusters/" class="nav-list-link">postgresql_clusters</a> </li><li class="nav-list-item "> <a href="/v2.0/reference/provose_config/" class="nav-list-link">provose_config</a> </li><li class="nav-list-item "> <a href="/v2.0/reference/redis_clusters/" class="nav-list-link">redis_clusters</a> </li><li class="nav-list-item "> <a href="/v2.0/reference/s3_buckets/" class="nav-list-link">s3_buckets</a> </li><li class="nav-list-item "> <a href="/v2.0/reference/secrets/" class="nav-list-link">secrets</a> </li><li class="nav-list-item "> <a href="/v2.0/reference/source/" class="nav-list-link">source</a> </li></ul></li><li class="nav-list-item "><a href="/v2.0/debugging/" class="nav-list-link">Debugging</a></li><li class="nav-list-item "><a href="/v2.0/uninstalling/" class="nav-list-link">Uninstalling Provose</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/v1.1/" class="nav-list-link">Docs v1.1 (Deprecated)</a><ul class="nav-list "><li class="nav-list-item "><a href="/v1.1/release-notes/" class="nav-list-link">Release notes</a></li><li class="nav-list-item "><a href="/v1.1/tutorial/" class="nav-list-link">Tutorial</a></li><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/v1.1/reference/" class="nav-list-link">Reference v1.1 (Deprecated)</a><ul class="nav-list"><li class="nav-list-item "> <a href="/v1.1/reference/containers/" class="nav-list-link">containers</a> </li><li class="nav-list-item "> <a href="/v1.1/reference/ec2_instances/" class="nav-list-link">ec2_instances</a> </li><li class="nav-list-item "> <a href="/v1.1/reference/elasticsearch_clusters/" class="nav-list-link">elasticsearch_clusters</a> </li><li class="nav-list-item "> <a href="/v1.1/reference/images/" class="nav-list-link">images</a> </li><li class="nav-list-item "> <a href="/v1.1/reference/mysql_clusters/" class="nav-list-link">mysql_clusters</a> </li><li class="nav-list-item "> <a href="/v1.1/reference/overrides/" class="nav-list-link">overrides</a> </li><li class="nav-list-item "> <a href="/v1.1/reference/postgresql_clusters/" class="nav-list-link">postgresql_clusters</a> </li><li class="nav-list-item "> <a href="/v1.1/reference/provose_config/" class="nav-list-link">provose_config</a> </li><li class="nav-list-item "> <a href="/v1.1/reference/redis_clusters/" class="nav-list-link">redis_clusters</a> </li><li class="nav-list-item "> <a href="/v1.1/reference/s3_buckets/" class="nav-list-link">s3_buckets</a> </li><li class="nav-list-item "> <a href="/v1.1/reference/secrets/" class="nav-list-link">secrets</a> </li><li class="nav-list-item "> <a href="/v1.1/reference/source/" class="nav-list-link">source</a> </li></ul></li><li class="nav-list-item "><a href="/v1.1/debugging/" class="nav-list-link">Debugging</a></li><li class="nav-list-item "><a href="/v1.1/uninstalling/" class="nav-list-link">Uninstalling Provose</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/v1.0/" class="nav-list-link">Docs v1.0 (Deprecated)</a><ul class="nav-list "><li class="nav-list-item "><a href="/v1.0/release-notes/" class="nav-list-link">Release notes</a></li><li class="nav-list-item "><a href="/v1.0/tutorial/" class="nav-list-link">Tutorial</a></li><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/v1.0/reference/" class="nav-list-link">Reference v1.0 (Deprecated)</a><ul class="nav-list"><li class="nav-list-item "> <a href="/v1.0/reference/containers/" class="nav-list-link">containers</a> </li><li class="nav-list-item "> <a href="/v1.0/reference/ec2_instances/" class="nav-list-link">ec2_instances</a> </li><li class="nav-list-item "> <a href="/v1.0/reference/elasticsearch_clusters/" class="nav-list-link">elasticsearch_clusters</a> </li><li class="nav-list-item "> <a href="/v1.0/reference/images/" class="nav-list-link">images</a> </li><li class="nav-list-item "> <a href="/v1.0/reference/mysql_clusters/" class="nav-list-link">mysql_clusters</a> </li><li class="nav-list-item "> <a href="/v1.0/reference/overrides/" class="nav-list-link">overrides</a> </li><li class="nav-list-item "> <a href="/v1.0/reference/postgresql_clusters/" class="nav-list-link">postgresql_clusters</a> </li><li class="nav-list-item "> <a href="/v1.0/reference/provose_config/" class="nav-list-link">provose_config</a> </li><li class="nav-list-item "> <a href="/v1.0/reference/redis_clusters/" class="nav-list-link">redis_clusters</a> </li><li class="nav-list-item "> <a href="/v1.0/reference/s3_buckets/" class="nav-list-link">s3_buckets</a> </li><li class="nav-list-item "> <a href="/v1.0/reference/secrets/" class="nav-list-link">secrets</a> </li><li class="nav-list-item "> <a href="/v1.0/reference/source/" class="nav-list-link">source</a> </li></ul></li><li class="nav-list-item "><a href="/v1.0/debugging/" class="nav-list-link">Debugging</a></li><li class="nav-list-item "><a href="/v1.0/uninstalling/" class="nav-list-link">Uninstalling Provose</a></li></ul></li></ul> </nav> <footer class="site-footer"> This site uses <a href="https://github.com/pmarsceill/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll. </footer> </div> <div class="main" id="top"> <div id="main-header" class="main-header"> <div class="search"> <div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search Provose" aria-label="Search Provose" autocomplete="off"> <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label> </div> <div id="search-results" class="search-results"></div> </div> <nav aria-label="Auxiliary" class="aux-nav"> <ul class="aux-nav-list"> <li class="aux-nav-list-item"> <a href="https://github.com/provose/provose.github.io/" class="site-button" > Docs on GitHub </a> </li> <li class="aux-nav-list-item"> <a href="https://github.com/provose/provose/" class="site-button" > Provose on GitHub </a> </li> <li class="aux-nav-list-item"> <a href="https://neocrym.com" class="site-button" > Neocrym.com </a> </li> </ul> </nav> </div> <div id="main-content-wrap" class="main-content-wrap"> <nav aria-label="Breadcrumb" class="breadcrumb-nav"> <ol class="breadcrumb-nav-list"> <li class="breadcrumb-nav-list-item"><a href="/v3.0/">Docs v3.0 (Stable)</a></li> <li class="breadcrumb-nav-list-item"><a href="/v3.0/reference/">Reference v3.0 (Stable)</a></li> <li class="breadcrumb-nav-list-item"><span>batch</span></li> </ol> </nav> <div id="main-content" class="main-content" role="main"> <h1 id="batch"> <a href="#batch" class="anchor-heading" aria-labelledby="batch"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> batch </h1> <h2 id="description"> <a href="#description" class="anchor-heading" aria-labelledby="description"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Description </h2> <p>The Provose <code class="language-plaintext highlighter-rouge">batch</code> configures resources for AWS Batch, which is fully-managed batch processing system for Dockerized workloads.</p> <h3 id="how-aws-batch-works"> <a href="#how-aws-batch-works" class="anchor-heading" aria-labelledby="how-aws-batch-works"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> How AWS Batch works </h3> <p>A full explanation of AWS Batch is outside the scope of the Provose documentation. You can learn more by reading the <a href="https://docs.aws.amazon.com/batch/index.html">AWS Batch documentation</a>.</p> <p>However, there are some important AWS Batch concepts to understand in order to use them with Provose:</p> <ul> <li> <p><strong>Jobs</strong> – A Job describes a computation to be done as described with a Docker image and some parameters (see below). <em>This Provose module does not specify or submit Jobs.</em> You must submit them with the AWS Console, the AWS API or the AWS CLI. The AWS Batch documentation page titled <a href="https://docs.aws.amazon.com/batch/latest/userguide/submit_job.html">Submitting a Job</a> has more information.</p> </li> <li> <p><strong>Job Definitions</strong> – A Job Definition is a blueprint for how Jobs are made. Job Definitions are configured below under the <code class="language-plaintext highlighter-rouge">job_definitions</code> key. Some of the parameters specified in a Job Definition can be overriden when specifying a job.</p> </li> <li> <p><strong>Docker images</strong> – AWS Batch Job Definitions are based on a Docker image that contains the code to be run in a job. You can read more about building and running Docker images on your local machine in <a href="https://docs.docker.com/get-started/part2/">the Docker documentation</a>. You can create images on your your local computer and <a href="../images/">use Provose to upload your images</a> to Amazon Web Services, after which they will be available for AWS Batch.</p> </li> <li> <p><strong>Job Queues</strong> – A Job Queue accepts Jobs until the Compute Environment is ready to accept the Job. You can define multiple Job Queues with different priorities below with the <code class="language-plaintext highlighter-rouge">job_queues</code> key.</p> </li> <li> <p><strong>Compute Environments</strong> – A Compute Environment pulls Jobs from the Job Queues to run them. A Compute Environment contains a pool of EC2 instances–with instance types of your choosing. The number of instances in the Compute Environment can scale up or down with the length of the queue.</p> </li> </ul> <p>You can read more precise versions of the above definitions in the <a href="https://docs.aws.amazon.com/batch/latest/userguide/what-is-batch.html">AWS Batch documentation</a>.</p> <p>AWS Batch allows many-to-many configurations between Job Definitions and Compute Environments, but for the sake of simplicity, Provose assumes that you’ll only want one Compute Environment for every Job Definition you write.</p> <p>If you need more complex configurations, you should write your AWS Batch configuration directly with the <a href="https://registry.terraform.io/providers/hashicorp/aws/3.0.0/docs/resources/batch_compute_environment">Terraform AWS Batch module</a>.</p> <h3 id="security-limitations-of-aws-batch"> <a href="#security-limitations-of-aws-batch" class="anchor-heading" aria-labelledby="security-limitations-of-aws-batch"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Security limitations of AWS Batch </h3> <p>AWS Elastic Container Service (ECS) can fetch secrets from AWS Secrets Manager and present them as environment variables to a container. However, AWS Batch currently does not have a similar integration with Secrets Manager. If you want to pass secrets to AWS Batch using environment variables, they will not be encrypted.</p> <p>If you want to pass environment variables to a container using AWS Batch, you can use the <code class="language-plaintext highlighter-rouge">environment</code> key documented below. You can use this method to pass secret values, but it would be more secure for your container process to contact AWS Secrets Manager directly.</p> <h3 id="naming-conventions"> <a href="#naming-conventions" class="anchor-heading" aria-labelledby="naming-conventions"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Naming conventions </h3> <p>The names you provide Provose for queue and job names are global within the AWS Region. This means that if you use AWS Batch in two different Provose modules, you should take care not to reuse the same names.</p> <h2 id="examples"> <a href="#examples" class="anchor-heading" aria-labelledby="examples"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Examples </h2> <div class="language-terraform highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">module</span> <span class="s2">"myproject"</span> <span class="p">{</span>
  <span class="nx">source</span> <span class="p">=</span> <span class="s2">"github.com/provose/provose?ref=v3.0.0"</span>
  <span class="nx">provose_config</span> <span class="p">=</span> <span class="p">{</span>
    <span class="nx">authentication</span> <span class="p">=</span> <span class="p">{</span>
      <span class="nx">aws</span> <span class="p">=</span> <span class="p">{</span>
        <span class="nx">region</span> <span class="p">=</span> <span class="s2">"us-east-1"</span>
      <span class="p">}</span>
    <span class="p">}</span>
    <span class="nx">name</span>                 <span class="p">=</span> <span class="s2">"myproject"</span>
    <span class="nx">internal_root_domain</span> <span class="p">=</span> <span class="s2">"example-internal.com"</span>
    <span class="nx">internal_subdomain</span>   <span class="p">=</span> <span class="s2">"production"</span>
  <span class="p">}</span>
  <span class="nx">batch</span> <span class="p">=</span> <span class="p">{</span>
    <span class="s2">"compute-environment-1"</span> <span class="p">=</span> <span class="p">{</span>
      <span class="nx">instances</span> <span class="p">=</span> <span class="p">{</span>
        <span class="nx">instance_types</span>           <span class="p">=</span> <span class="p">[</span><span class="s2">"m5.large"</span><span class="p">]</span>
        <span class="nx">compute_environment_type</span> <span class="p">=</span> <span class="s2">"SPOT"</span>
        <span class="nx">min_vcpus</span>                <span class="p">=</span> <span class="mi">0</span>
        <span class="nx">max_vcpus</span>                <span class="p">=</span> <span class="mi">2</span>
      <span class="p">}</span>
      <span class="nx">job_queues</span> <span class="p">=</span> <span class="p">{</span>
        <span class="s2">"mainqueue"</span> <span class="p">=</span> <span class="p">{</span>
          <span class="nx">state</span>    <span class="p">=</span> <span class="s2">"ENABLED"</span>
          <span class="nx">priority</span> <span class="p">=</span> <span class="mi">1</span>
        <span class="p">}</span>
      <span class="p">}</span>
      <span class="nx">job_definitions</span> <span class="p">=</span> <span class="p">{</span>
        <span class="s2">"job-1"</span> <span class="p">=</span> <span class="p">{</span>
          <span class="nx">image</span> <span class="p">=</span> <span class="p">{</span>
            <span class="nx">name</span>             <span class="p">=</span> <span class="s2">"busybox"</span>
            <span class="nx">tag</span>              <span class="p">=</span> <span class="s2">"latest"</span>
            <span class="nx">private_registry</span> <span class="p">=</span> <span class="kc">false</span>
          <span class="p">}</span>
          <span class="nx">vcpus</span>   <span class="p">=</span> <span class="mi">1</span>
          <span class="nx">memory</span>  <span class="p">=</span> <span class="mi">512</span>
          <span class="nx">command</span> <span class="p">=</span> <span class="p">[</span><span class="s2">"echo"</span><span class="p">,</span> <span class="s2">"hello"</span><span class="p">,</span> <span class="s2">"world"</span><span class="p">]</span>
          <span class="nx">environment</span> <span class="p">=</span> <span class="p">{</span>
            <span class="nx">SOME_KEY</span> <span class="p">=</span> <span class="s2">"some_var"</span>
          <span class="p">}</span>
        <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>

</code></pre></div></div> <h2 id="inputs"> <a href="#inputs" class="anchor-heading" aria-labelledby="inputs"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Inputs </h2> <ul> <li> <p><code class="language-plaintext highlighter-rouge">instances</code> – <strong>Required.</strong> This is an object that defines the compute resources for the given AWS Batch Compute Environment.</p> <ul> <li> <p><code class="language-plaintext highlighter-rouge">instance_types</code> – <strong>Required.</strong> This is a list of AWS EC2 instance types that will run the Jobs. Not all instance types are available for AWS Batch. The list must also only contain instances of the same CPU architecture–you cannot have both x86 instances and ARM instances in the same list.</p> </li> <li> <p><code class="language-plaintext highlighter-rouge">compute_environment_type</code> – <strong>Required.</strong> The type of compute environment. Set this to <code class="language-plaintext highlighter-rouge">"EC2"</code> to deploy EC2 On-Demand instances for this Compute Environment. If you set this vlaue to <code class="language-plaintext highlighter-rouge">"SPOT"</code>, you can save money by using AWS Spot Instances instead.</p> </li> <li> <p><code class="language-plaintext highlighter-rouge">min_vcpus</code> – <strong>Required.</strong> This is the minimum number of virtual CPUs (vCPUs) to maintain in the Compute Environment. These many vCPUs will be continually available for new jobs, even if the queue is empty. However, you can set this value to <code class="language-plaintext highlighter-rouge">0</code> to instruct AWS Batch to shut off the compute resources when the queue is empty.</p> </li> <li> <p><code class="language-plaintext highlighter-rouge">max_vcpus</code> – <strong>Required.</strong> This is the maximum number of virtual CPUs (vCPUs) that are available in the Compute Environment.o</p> </li> <li> <p><code class="language-plaintext highlighter-rouge">ami_id</code> – <strong>Optional.</strong> If you wish, you can set this to a custom Amazon Machine Image for the compute resources to run. Presumably most of your job’s software is written in the Docker container, but you may need a custom AMI to mount filesystems or install device drivers.</p> </li> </ul> </li> <li> <p><code class="language-plaintext highlighter-rouge">job_queues</code> – <strong>Required.</strong> This is <strong>mapping</strong> <em>from</em> queue names to objects with the given keys.</p> <ul> <li> <p><code class="language-plaintext highlighter-rouge">state</code> – <strong>Required.</strong> This is <code class="language-plaintext highlighter-rouge">"ENABLED"</code> to enable the queue or <code class="language-plaintext highlighter-rouge">"DISABLED"</code> to disable the queue.</p> </li> <li> <p><code class="language-plaintext highlighter-rouge">priority</code> – <strong>Required.</strong> This is an integer value that describes the priority of this queue. A larger number gives this queue a higher priority in the attached Compute Environment.</p> </li> </ul> </li> <li> <p><code class="language-plaintext highlighter-rouge">job_definitions</code> – <strong>Optional.</strong> This is a <strong>mapping</strong> from job definition names to job definition values.</p> <ul> <li> <p><code class="language-plaintext highlighter-rouge">image</code> – <strong>Required.</strong> This defines the Docker image deployed by this AWS Batch job.</p> <ul> <li> <p><code class="language-plaintext highlighter-rouge">name</code> – <strong>Required.</strong> The name of the Docker image to deploy.</p> </li> <li> <p><code class="language-plaintext highlighter-rouge">tag</code> – <strong>Required.</strong> This is the tag of the image to deploy. This is often a specific version or the string <code class="language-plaintext highlighter-rouge">"latest"</code>.</p> </li> <li> <p><code class="language-plaintext highlighter-rouge">private_registry</code> – <strong>Required.</strong> Set this to <code class="language-plaintext highlighter-rouge">true</code> if the given image is ion your AWS account’s private Elastic Container Registry. If set to <code class="language-plaintext highlighter-rouge">false</code>, AWS Batch will look for an image with the given name in the public Docker Hub registry.</p> </li> </ul> </li> <li> <p><code class="language-plaintext highlighter-rouge">vcpus</code> – <strong>Required.</strong> The number of vCPUs to dedicate to each Job that belongs to this Job Definition.</p> </li> <li> <p><code class="language-plaintext highlighter-rouge">memory</code> – <strong>Required.</strong> The amount of memory–in megabytes–designated to each job.</p> </li> <li> <p><code class="language-plaintext highlighter-rouge">command</code> – <strong>Required.</strong> This is the command to pass to the Docker container. Note that AWS Batch does not currently let you override the container entrypoint.</p> </li> <li> <p><code class="language-plaintext highlighter-rouge">environment</code> – <strong>Optional.</strong> This is <strong>mapping</strong> from environment variable names to their values. Remember, these values are uenncrypted. AWS Batch currently does not have a way to directly pull encrypted secrets from AWS Secrets Manager.</p> </li> </ul> </li> </ul> <h2 id="outputs"> <a href="#outputs" class="anchor-heading" aria-labelledby="outputs"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Outputs </h2> <!-- - `batch.aws_iam_role.batch__execution_role` -- - `batch.aws_iam_role.batch__service_role` -- - `batch.aws_iam_role.batch__spot_fleet_role` -- - `batch.aws_iam_instance_profile.batch__execution_role` -- --> <ul> <li> <p><code class="language-plaintext highlighter-rouge">batch.aws_security_group.batch</code> – A mapping from AWS Batch Compute Environment names to <a href="https://registry.terraform.io/providers/hashicorp/aws/3.0.0/docs/resources/security_group"><code class="language-plaintext highlighter-rouge">aws_security_group</code> resources</a>. By default, the security groups allow AWS Batch Jobs outbound access to the Internet. This may be undesirable for you if you are running jobs containing untrusted code or have other needs for network isolation.</p> </li> <li> <p><code class="language-plaintext highlighter-rouge">batch.aws_batch_compute_environment.batch</code> – A mapping from AWS Batch Compute Environment names to <a href="https://registry.terraform.io/providers/hashicorp/aws/3.0.0/docs/resources/batch_compute_environment"><code class="language-plaintext highlighter-rouge">aws_batch_compute_environment</code> resources</a>.</p> </li> <li> <p><code class="language-plaintext highlighter-rouge">batch.aws_batch_job_queue.batch</code> – A mapping from AWS Batch Job Queue names to <a href="https://registry.terraform.io/providers/hashicorp/aws/3.0.0/docs/resources/batch_job_queue"><code class="language-plaintext highlighter-rouge">aws_batch_job_queue</code> resources</a>.</p> </li> <li> <p><code class="language-plaintext highlighter-rouge">batch.aws_batch_job_definition.batch</code> – A mapping from AWS Batch Job Definition names to <a href="https://registry.terraform.io/providers/hashicorp/aws/3.0.0/docs/resources/batch_job_definition"><code class="language-plaintext highlighter-rouge">aws_batch_job_definition</code> resources</a>.</p> </li> </ul> <hr> <footer> <p class="text-small text-grey-dk-100 mb-0">Copyright &copy; 2020 <a href="https://neocrym.com">Neocrym Records Inc</a>. Distributed via an <a href="https://github.com/provose/provose.github.io/blob/master/LICENSE">MIT license</a>. <a href="/privacy/">Privacy Policy</a>.</p> </footer> </div> </div> <div class="search-overlay"></div> </div> </body> </html>
